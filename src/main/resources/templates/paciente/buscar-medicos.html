<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Buscar M√©dicos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .medico-card {
            transition: transform 0.2s;
            border-left: 4px solid #0d6efd;
        }
        .medico-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <!-- Header -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1>Buscar M√©dicos</h1>
            <a th:href="@{/paciente/perfil}" class="btn btn-outline-secondary">
                ‚Üê Volver al Perfil
            </a>
        </div>

        <!-- Formulario de B√∫squeda -->
        <div class="card mb-4">
            <div class="card-header">
                <h5 class="card-title mb-0">Criterios de B√∫squeda</h5>
            </div>
            <div class="card-body">
                <form th:action="@{/paciente/buscar-medicos}" method="get">
                    <div class="row g-3">
                        <!-- B√∫squeda por Nombre -->
                        <div class="col-md-6">
                            <label class="form-label">Buscar por Nombre</label>
                            <input type="text" name="nombre" class="form-control" 
                                   th:value="${nombreBuscado}" 
                                   placeholder="Ingrese nombre del m√©dico">
                        </div>
                        
                        <!-- B√∫squeda por Especialidad -->
                        <div class="col-md-6">
                            <label class="form-label">Buscar por Especialidad</label>
                            <select name="especialidadId" class="form-control">
                                <option value="">Todas las especialidades</option>
                                <option th:each="esp : ${especialidades}" 
                                        th:value="${esp.id}" 
                                        th:text="${esp.nombre}"
                                        th:selected="${especialidadSeleccionada == esp.id}">
                                </option>
                            </select>
                        </div>
                    </div>
                    
                    <!-- Botones -->
                    <div class="row mt-3">
                        <div class="col-md-12">
                            <button type="submit" class="btn btn-primary">
                                üîç Buscar
                            </button>
                            <a th:href="@{/paciente/buscar-medicos}" class="btn btn-outline-secondary">
                                üóëÔ∏è Limpiar
                            </a>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- Resultados -->
        <div th:if="${medicos != null}">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2>M√©dicos Disponibles</h2>
                <span class="badge bg-primary" th:text="'Encontrados: ' + ${medicos.size()}"></span>
            </div>

            <!-- Mensaje si no hay resultados -->
            <div th:if="${medicos.empty}" class="alert alert-warning">
                No se encontraron m√©dicos con los criterios de b√∫squeda seleccionados.
            </div>

            <!-- Lista de M√©dicos -->
            <div th:each="medico : ${medicos}" class="card medico-card mb-3">
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-8">
                            <h5 class="card-title" th:text="${medico.nombreCompleto}">Nombre del M√©dico</h5>
                            <p class="card-text mb-1">
                                <strong>Especialidad:</strong> 
                                <span class="badge bg-info" th:text="${medico.especialidadNombre}">Especialidad</span>
                            </p>
                            <p class="card-text mb-1" th:if="${medico.persona?.email}">
                                <strong>Email:</strong> 
                                <span th:text="${medico.persona.email}">email@ejemplo.com</span>
                            </p>
                            <p class="card-text mb-1" th:if="${medico.persona?.telefono}">
                                <strong>Tel√©fono:</strong> 
                                <span th:text="${medico.persona.telefono}">900000000</span>
                            </p>
                        </div>
                        <div class="col-md-4 text-end">
                            <button class="btn btn-success btn-sm">
                                üìÖ Solicitar Cita
                            </button>
                            <br>
                            <small class="text-muted">Disponible para consulta</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Informaci√≥n del Paciente (contexto) -->
        <div class="card mt-4">
            <div class="card-body bg-light">
                <h6>Buscando como Paciente:</h6>
                <p class="mb-0" th:if="${paciente != null}">
                    <strong th:text="${paciente.nombreCompleto}"></strong> | 
                    <span th:text="${paciente.seguroMedico} ?: 'Sin seguro m√©dico'"></span>
                </p>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>